-- LIST OF ACTIVE UNMAPPED ROUTES
select * from CDSPROD1.RDD_BUSROUTEVARIANT
where ceaseddate > sysdate and MAPPEDROUTE = 'N' 
order by routevariant asc
;

-- GET ALL UNMAPPED ROUTE JOURNEY SEGMENTS FOR A GIVEN DAYKEY
select a.daykey, a.smartcardid, a.originlocationname, a.destinationlocationname, a.entrytimestamp, a.exittimestamp, a.startsequenceno, a.endsequenceno, a.routevariant, b.routename, a.transportmode, a.journeytype, a.starttransactiontype, a.endtransactiontype, a.cardtypekey, a.subsystemid
from CDSPROD1.DD_JOURNEY_SEGMENT a
join CDSPROD1.RDD_BUSROUTEVARIANT b
on a.ROUTEVARIANTKEY = b.ROUTEVARIANTKEY
where a.TRANSPORTMODE = 'BUS'
and a.daykey = 14371
and a.routevariantkey in 
(
'2462547',
'2476726',
'2467174',
'2480868',
'2475519',
'2462677',
'2463780',
'2476443',
'2462913',
'2476223',
'2475520',
'2464007',
'2462438',
'2477082',
'2462914',
'2475971',
'2462917',
'2476860',
'2463350',
'2477085',
'2462678',
'2475975',
'2462440',
'2476444',
'2462704',
'2476244',
'2474202',
'2442843',
'2318616',
'2336785',
'2360813',
'2375041',
'2467037',
'2481289',
'2466940',
'2481427',
'2474091',
'2442499',
'2466931',
'2481069',
'2474448',
'2442849',
'2474563',
'2442501',
'2474341',
'2442974',
'2474570',
'2443104',
'2463594',
'2476475',
'2463598',
'2476477',
'2473859',
'2443369',
'2467374',
'2481424',
'2467239',
'2480818',
'2473869',
'2442870',
'2467609',
'2480723',
'2474360',
'2442994',
'2474704',
'2442657',
'2467370',
'2481070',
'2473990',
'2442886',
'2473879',
'2443019',
'2474710',
'2442438',
'2467415',
'2480579',
'2467392',
'2480555',
'2462867',
'2476817',
'2463519',
'2475934',
'2463093',
'2475483',
'2463094',
'2476819',
'2467224',
'2481014',
'2467550',
'2481134',
'2318771',
'2336666',
'2360406',
'2374926',
'2444412',
'2443933',
'2444567',
'2076650',
'2109988',
'2203510',
'2349544',
'2434973',
'2076338',
'2110153',
'2203427',
'2349545',
'2435383',
'2076417',
'2110317',
'2203679',
'2350108',
'2435470',
'2076911',
'2110241',
'2203841',
'2349796',
'2435554',
'2076574',
'2110318',
'2203842',
'2349971',
'2435225',
'2444446',
'2076514',
'2109970',
'2203774',
'2349734',
'2435398',
'2076829',
'2110450',
'2203689',
'2350056',
'2435334',
'2444135',
'2443812',
'2461930',
'2473601',
'2443827',
'2444321',
'2472523',
'2469250',
'2475143',
'2477591',
'2469627',
'2472338',
'2474896',
'2477830',
'2468638',
'2478608',
'2076426',
'2110395',
'2203436',
'2349637',
'2435565',
'2076585',
'2110301',
'2203445',
'2349643',
'2434994',
'2443495',
'2444339',
'2443838',
'2443497',
'2462760',
'2477151',
'2467159',
'2480729',
'2467094',
'2480976',
'2467387',
'2480639',
'2466858',
'2478110',
'2466699',
'2478007',
'2467038',
'2480728',
'2463923',
'2462826',
'2476140',
'2472055',
'2468939',
'2460747',
'2441696',
'2469609',
'2472627',
'2475184',
'2477633',
'2472633',
'2475062',
'2469411',
'2477750',
'2472563',
'2475000',
'2469342',
'2477494',
'2472637',
'2475066',
'2469344',
'2477869',
'2471427',
'2465959',
'2480434',
'2469559',
'2474881',
'2472703',
'2477695',
'2467069',
'2480892',
'2467413',
'2480577',
'2467722',
'2481281',
'2467421',
'2480683',
'2467137',
'2481057',
'2466924',
'2481056',
'2467126',
'2481265',
'2467009',
'2480929',
'2076725',
'2109919',
'2203463',
'2272213',
'2318103',
'2324787',
'2318555',
'2326041',
'2342745',
'2347691',
'2349592',
'2350384',
'2336601',
'2356644',
'2360355',
'2360557',
'2367802',
'2375051',
'2380726',
'2392923',
'2389220',
'2400329',
'2395049',
'2395313',
'2391236',
'2435491',
'2425112',
'2433810',
'2423821',
'2415789',
'2407484',
'2412990',
'2409902',
'2472993',
'2475402',
'2468407',
'2470661',
'2473110',
'2462142',
'2466316',
'2469789',
'2466378',
'2472187',
'2466461',
'2467676',
'2471117',
'2473492',
'2460751',
'2474761',
'2468958',
'2474817',
'2466793',
'2470306',
'2458675',
'2472662',
'2463944',
'2469341',
'2443393',
'2442341',
'2443742',
'2444765',
'2438609',
'2441683',
'2446002',
'2476607',
'2481519',
'2477293',
'2480551',
'2477589',
'2478958',
'2477966',
'2478179',
'2481318',
'2076641',
'2110482',
'2203370',
'2272178',
'2324788',
'2325981',
'2318787',
'2318047',
'2342693',
'2348068',
'2349850',
'2350458',
'2336457',
'2356583',
'2360245',
'2360904',
'2367847',
'2375474',
'2380810',
'2400281',
'2389297',
'2395097',
'2391220',
'2395415',
'2393067',
'2425237',
'2433866',
'2435248',
'2407508',
'2415837',
'2413146',
'2409761',
'2423755',
'2472948',
'2468307',
'2470662',
'2475455',
'2471916',
'2473176',
'2469716',
'2462200',
'2463288',
'2466351',
'2466490',
'2458374',
'2460740',
'2468910',
'2470096',
'2471418',
'2473798',
'2466897',
'2472715',
'2475085',
'2474045',
'2465662',
'2467100',
'2469416',
'2442356',
'2444942',
'2438610',
'2444248',
'2443123',
'2445913',
'2441716',
'2481622',
'2477367',
'2478508',
'2480651',
'2479693',
'2477766',
'2477901',
'2478024',
'2476378',
'2466669',
'2478046',
'2466573',
'2478203',
'2444225',
'2444054',
'2474414',
'2443230',
'2474172',
'2442662',
'2444055',
'2466300',
'2470913',
'2479939',
'2466016',
'2471506',
'2479630',
'2410014',
'2470319',
'2466303',
'2471074',
'2480236',
'2272203',
'2356624',
'2391245',
'2433820',
'2272225',
'2356526',
'2391263',
'2433822',
'2471820',
'2465494',
'2479642',
'2466027',
'2471659',
'2480367',
'2444056',
'2443734',
'2466424',
'2466434',
'2466428',
'2466485',
'2458520',
'2458713',
'2463933',
'2476790',
'2463718',
'2476367'
)
;